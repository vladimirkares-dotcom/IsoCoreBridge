<?xml version="1.0" encoding="utf-8"?>
<views:MenuPage
    x:Class="IsoCore.App.Views.ProjectsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:views="using:IsoCore.App.Views"
    mc:Ignorable="d">

    <views:MenuPage.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Styles/ListPageStyles.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </views:MenuPage.Resources>

    <Grid Background="{StaticResource IcbdWindowBackgroundBrush}"
          Style="{StaticResource IcbdPageGrid}"
          ColumnSpacing="{StaticResource IcbdSpacingMedium}"
          RowSpacing="{StaticResource IcbdSpacingMedium}">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="3*" />
        </Grid.ColumnDefinitions>

        <!-- Levý horní blok: Akce projektu -->
        <Border Grid.Row="0"
                Grid.Column="0"
                Style="{StaticResource IcbdDashboardCardBaseStyle}"
                Padding="{StaticResource IcbdPaddingL}">
            <StackPanel Orientation="Vertical"
                        Spacing="{StaticResource IcbdSpacingMedium}">
                <TextBlock Text="Akce projektu"
                           Style="{StaticResource IcbdSubheaderText}" />
                <StackPanel Style="{StaticResource PageActionsPanel}">
                                        <Button x:Name="NewProjectButton"
                            Content="Založit projekt"
                            Style="{StaticResource IcbdPrimaryButton}"
                            Click="NewProjectButton_Click" />
                    <Button x:Name="OpenProjectButton"
                            Content="Otevřít projekt"
                            Click="OpenProjectButton_Click"
                            IsEnabled="False"
                            Style="{StaticResource StretchHorizontalSecondaryButton}" />
                    <Button x:Name="EditProjectButton"
                            Content="Editovat projekt"
                            Click="EditProjectButton_Click"
                            IsEnabled="{Binding HasSelectedProject}"
                            Style="{StaticResource StretchHorizontalSecondaryButton}" />
                    <Button x:Name="DeleteProjectButton"
                            Content="Smazat projekt"
                            Click="DeleteProjectButton_Click"
                            IsEnabled="{Binding HasSelectedProject}"
                            Style="{StaticResource StretchHorizontalSecondaryButton}" />
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Levý spodní blok: Poslední změny -->
        <Border Grid.Row="1"
                Grid.Column="0"
                Style="{StaticResource StretchVerticalBorder}"
                Padding="{StaticResource IcbdPaddingL}">
            <StackPanel Spacing="{StaticResource IcbdSpacingSmall}">
                <TextBlock Text="Poslední změny"
                           Style="{StaticResource IcbdSectionHeaderText}" />
                <TextBlock Text="Zatím žádné změny k zobrazení."
                           Style="{StaticResource IcbdBodyTextBlockStyle}" />
            </StackPanel>
        </Border>

        <!-- Pravý horní blok: Seznam projektů -->
        <Border Grid.Row="0"
                Grid.Column="1"
                Style="{StaticResource StretchVerticalBorder}"
                Padding="{StaticResource IcbdPaddingL}">
            <Grid RowDefinitions="Auto,*,Auto"
                  RowSpacing="{StaticResource IcbdSpacingMedium}">

                <!-- Header: název + počet vlevo, filtry vpravo -->
                <Grid Grid.Row="0"
                      RowDefinitions="Auto,Auto"
                      ColumnDefinitions="*,2*"
                      RowSpacing="{StaticResource IcbdSpacingSmall}">
                    <TextBlock Grid.Row="0"
                               Grid.Column="0"
                               Text="Seznam projektů"
                               Style="{StaticResource IcbdSectionHeaderText}" />
                    <TextBlock Grid.Row="1"
                               Grid.Column="0"
                               Style="{StaticResource IcbdSubheaderText}">
                        <Run Text="Počet projektů: " />
                        <Run Text="{Binding Projects.Count}" />
                    </TextBlock>

                    <Grid Grid.Row="0"
                          Grid.RowSpan="2"
                          Grid.Column="1"
                          Style="{StaticResource ListFilterGrid}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Button Grid.Column="0"
                                Content="Filtr"
                                Style="{StaticResource StretchHorizontalSecondaryButton}" />
                        <Button Grid.Column="1"
                                Content="Hledat"
                                Style="{StaticResource StretchHorizontalSecondaryButton}" />
                        <Button Grid.Column="2"
                                Content="Řazení"
                                Style="{StaticResource StretchHorizontalSecondaryButton}" />
                    </Grid>
                </Grid>

                <!-- List projektů -->
                <ListView Grid.Row="1"
                          ItemsSource="{Binding Projects}"
                          SelectedItem="{Binding SelectedProject, Mode=TwoWay}"
                            SelectionChanged="OnProjectSelectionChanged">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid Style="{StaticResource IcbdListItemContainer}"
                                  DoubleTapped="OnProjectItemDoubleTapped"
                                  RowDefinitions="Auto,Auto"
                                  ColumnDefinitions="Auto,*"
                                  RowSpacing="{StaticResource IcbdSpacingSmall}"
                                  ColumnSpacing="{StaticResource IcbdSpacingSmall}">
                                <!-- First row: code + name -->
                                <TextBlock Grid.Row="0"
                                           Grid.Column="0"
                                           Text="{Binding ProjectCode}"
                                           Style="{StaticResource ProjectListCodeText}" />
                                <TextBlock Grid.Row="0"
                                           Grid.Column="1"
                                           Text="{Binding DisplayName}"
                                           Style="{StaticResource ProjectListTitleText}" />

                                <!-- Second row: status / description / other detail (compact) -->
                                <TextBlock Grid.Row="1"
                                           Grid.Column="0"
                                           Grid.ColumnSpan="2"
                                           Text="{Binding ProjectStatus}"
                                           Style="{StaticResource ProjectListStatusText}" />
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <!-- Popisek pod seznamem -->
                <StackPanel Grid.Row="2"
                            Spacing="{StaticResource IcbdSpacingSmall}">
                    <TextBlock Text="Vyberte projekt a otevřete jej pro detail."
                               Style="{StaticResource IcbdCaptionText}" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- Pravý spodní blok: Detail projektu -->
        <Border Grid.Row="1"
                Grid.Column="1"
                Style="{StaticResource StretchVerticalBorder}"
                Padding="{StaticResource IcbdPaddingL}">
            <StackPanel Spacing="{StaticResource IcbdSpacingMedium}">
                <TextBlock Text="Detail projektu"
                           Style="{StaticResource IcbdSectionHeaderText}" />
                <TextBlock Text="Vyberte projekt pro zobrazení detailu."
                           Style="{StaticResource IcbdBodyTextBlockStyle}" />
            </StackPanel>
        </Border>
    </Grid>
</views:MenuPage>
